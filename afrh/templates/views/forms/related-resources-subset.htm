<!-- Overall Condition CRUD Form -->
{% extends "views/forms/base.htm" %}
{% load staticfiles %}
{% load i18n %}

{% block form_controls %}
    <!-- Save/Discard Buttons for small, medium and large screens -->
    <span class="pull-right margin-top-minus-10 hidden-xs">
        <button type="button" class="cancel-edits btn btn-danger disabled"> 
            <i class="fa fa-times"></i>&nbsp; {% trans 'Discard edits' %}
        </button>
        <button type="submit" class="save-edits btn btn-success disabled"> 
            <i class="fa fa-check"></i>&nbsp; {% trans 'Save edits' %}
        </button>
    </span>
    <!-- Save/Discard Buttons for xs screens -->
    <span class="hidden-sm hidden-md hidden-lg">
        </br>
        <button type="button" class="cancel-edits btn btn-danger disabled"> 
            <i class="fa fa-times"></i>&nbsp; {% trans 'Discard edits' %}
        </button>
        <button type="submit" class="save-edits btn btn-success disabled"> 
            <i class="fa fa-check"></i>&nbsp; {% trans 'Save edits' %}
        </button>
    </span>
{% endblock form_controls %}

{% block form_content %}                                
<div class="relation-list">
    <div class="row margin-bottom-10">
        <div class="col-xs-12">
            <div class="padding-left-10">
                <dl style="margin-bottom: 0px;">
                    <dt>
                        <h5 id="arches-names-form" class="section-headline">{% trans 'Related Resources' %}</h5>
                    </dt>
                     <!-- Form -->
                    <dd class="arches-RDM-labels" data-bind="if: getEditedBranch()">
                        <div class="row" data-bind="visible: true" style="display:none;">
                            <div class="col-xs-12">
                                <form class="form-inline hidden-xs" role="form">
                                    <div class="form-group" style="width: 100%">
                                        <h4>
                                            <span class="arches-search-title" data-bind="text: getEditedBranch().relatedresourcename"></span>
                                            <span>
                                                <small class="arches-search-subtitle">
                                                    <i data-bind="attr: { class: getEditedBranchTypeInfo().icon }"></i>
                                                    <span data-bind="text: getEditedBranchTypeInfo().name"></span>
                                                </small>
                                            </span>
                                        </h4>
                                        <input style="width:80%; display: inline-block;" class="select2 arches-select2-crud-form name-type hidden-xs" id="resource-measurement-unit" data-bind="relationshipTypeSelect: true, select2: {value: getEditedBranch().relationship.relationshiptype, placeholder: 'Type', dataKey: 'RELATIONSHIP_TYPES.E32'}"></input>
                                        {% include 'views/components/add-item-button.htm' %}
                                        <div class="row" style="margin-top: 10px;margin-bottom: 10px;padding-right: 162px;">
                                            <!-- Classification and dates -->
                                            <div style="">
                                                <div id="from-date-section" class="col-xs-12 col-sm-6">
                                                    <div class="input-group datetimepicker" style ="width:100%;" >
                                                        <input type="text" id="date" style="height: 32px;" placeholder="{% trans 'from (yyyy-mm-dd)' %}" class="form-control datepicker" data-date-format="YYYY-MM-DD" data-bind="{value: getEditedBranch().relationship.datestarted, datePicker: true} ">
                                                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                                    </div>
                                                    <div class="hidden-sm hidden-md hidden-lg" style="margin-bottom: 5px;">
                                                    </div>
                                                </div>
                                                <div id="to-date-section" class="col-xs-12 col-sm-6">
                                                    <div class="input-group datetimepicker" style ="width:100%;" >
                                                        <input type="text" id="date" style="height: 32px;" placeholder="{% trans 'to (yyyy-mm-dd)' %}" class="form-control datepicker" data-date-format="YYYY-MM-DD" data-bind="{value: getEditedBranch().relationship.dateended, datePicker: true} ">
                                                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="arches-html-editor margin-top-5" style="width: 80%;">
                                            <div class="summernote" data-bind="summernote: {value: getEditedBranch().relationship.notes, options:{}}"></div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </dd>
                    <div class="alert alert-danger branch-invalid-alert" role="alert" style="display:none;">{% trans "All values must be populated." %}</div>
                </dl>
            </div>
        </div>
    </div>
    <div class="row margin-top-minus-5 margin-bottom-10" id="no-relationships" style="">
        <div class="col-xs-12">
            <div class="margin-left-5" data-bind="visible: true">
                <dl class="margin-bottom-10"> 
                    <dd class="margin-left-5">
                        <div data-bind="visible: viewModel.branch_lists().length == 0">
                            <p class="arches-CRUD-child text-primary">{% trans 'This resource has no relationships yet' %}</p>
                        </div>
                        <div data-bind='foreach: getBranchLists()'>
                            <div data-bind='if: relationship'>
                                <div class="arches-crud-record">
                                    <a href="javascript:void(0)" class="arches-CRUD-child" title="Delete this relationship"><i data-bind="click: $parent.deleteItem.bind($parent)" class="arches-CRUD-delete fa fa-times-circle"></i></a>
                                    <a href="javascript:void(0)" class="arches-CRUD-child arches-CRUD-edit" data-bind="click: $parent.editItem.bind($parent)" title="{% trans "Edit this relationship" %}">
                                        <strong data-bind='text: relationshiptypelabel'></strong>
                                        <span data-bind='text: relatedresourcename'></span>
                                    </a>
                                </div>
                                <div class="related-resource-details">
                                    <span data-bind='visible: relationship.datestarted'>
                                        <strong>From:</strong>
                                        <span data-bind='text: relationship.datestarted'></span>
                                    </span>
                                    <span data-bind='visible: relationship.dateended'>
                                        <strong>To:</strong>
                                        <span data-bind='text: relationship.dateended'></span>
                                    </span>
                                    <div data-bind='visible: relationship.notes'>
                                        <strong>Notes:</strong>
                                    </div>
                                    <div data-bind='visible: relationship.notes'>
                                        <span data-bind='text: relationship.notes'></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </dd>
                </dl>
            </div>
        </div>
    </div>
</div>

<div class="relation-form">
    <div class="margin-bottom-50">
        <div class="row" id="search-results" style="margin-left:0px; margin-right:0px;">
            <h2 id="search-results-count"  class="text-muted margin-left-5" style="margin-bottom: 30px;margin-top:0px">
                <span data-bind="text: total()"></span> Results &nbsp;
            </h2>
            <!-- Attribute  Filter -->
            <div class="row margin-top-minus-20" style="margin-right: 0px;"> 
                <div id="attribute" class="arches-time-filter" style="margin-right: 5px;">
                    <div class="" style="padding-bottom: 10px; padding-top: 30px; margin-bottom: 10px; margin-right: 20px;">
                        <div class="">
                            <div class="row" style="margin-bottom: 5px;">
                                <div class="col-xs-12">     
                                    <input class="select2 resource_search_widget arches-select2" name="" style="width:100%" placeholder="{% trans "Search for a resource..." %}" value="">
                                    <input class="select2 resource_search_widget_dropdown arches-select2" name="" style="width:100%" placeholder="{% trans "Search for a resource..." %}" value="">
                                </div>
                            </div>
                        </div>
                    </div>    
                </div>
                <div class="" style="margin-bottom: 20px;"></div>
            </div>
            <div class="s-results margin-bottom-50">

                <div class="row" id="map-filter-container" data-filtertext="{% trans "Map Filter Enabled" %}" style="margin-right: 20px;"> 
                    {% include 'views/search/map-filter.htm' %}
                </div>
                <div class="row" id="time-filter-container" data-filtertext="{% trans "Time Filter Enabled" %}"> 
                    {% include 'views/search/time-filter.htm' %}
                </div>
             -->
                <div class="row" id="search-results-container"> 
                    <!-- Content -->              
                    <div style="padding-top: 0px;">
                        <div class="row" style="">
                            <div class="col-xs-11 col-xs-offset-1 col-sm-4 col-sm-offset-7 col-md-3 map-loading loading-mask" style="display: none;">
                                <img src="{% static 'img/spinner.gif' %}" height="28" width="28" style="margin-top: 2px;">
                                <p class="map-loading-text">Loading results...</p>
                            </div>
                        </div>
                        <!-- Begin Search Results -->
                        <div class="col-xs-12">
                            <div id="search-results-list" data-bind="foreach: results, visible: true" style="display: none;">
                                <div  class="arches-search-item" data-bind="attr: { 'data-resourceid': resourceid }">
                                    <hr class="margin-10">
                                    <div class="inner-results padding-left-5">
                                        <h4>
                                            <span class="arches-search-title" data-bind="text: primaryname"></span> 
                                            &nbsp;
                                            <span class="">
                                                <small class="arches-search-subtitle"><i data-bind="attr: { class: typeIcon }"></i><span data-bind="text: typeName"></span></small>
                                            </span>
                                            <div class="btn-group pull-right" style="margin-top: 15px;margin-right: 10px;" data-bind="if: !relationBranch.editing()">
                                                <button type="button" class="btn btn-xs btn-primary arches-RDM-button" data-bind="text: relationBranch.related() ? '{% trans 'Edit Relationship' %}' : '{% trans 'Add Relationship' %}', click: editClick"></button>
                                            </div>
                                        </h4>
                                        <div data-bind="if: !editing()">
                                            <p data-bind="if: relationBranch.related()" class="arches-search-item-description">
                                                <strong>{% trans 'Relationship:' %}</strong>
                                                <span data-bind="text: relationBranch.relationshiptypelabel"></span>
                                            </p>
                                            <p data-bind="text:description" class="arches-search-item-description"></p>
                                        </div>
                                        <dd class="arches-RDM-labels" data-bind="if: relationBranchList.getEditedBranch() && relationBranchList.getEditedBranch() === relationBranch" style="margin-top:15px;">
                                            <div class="row" data-bind="visible: true" style="display:none;">
                                                <div class="col-xs-12">
                                                    <!-- Form for screens > xs -->
                                                    <form class="form-inline hidden-xs" role="form">
                                                        <div class="form-group" style="width: 100%">
                                                            <input style="width:80%; display: inline-block;" class="select2 arches-select2-crud-form name-type hidden-xs" id="resource-measurement-unit" data-bind="relationshipTypeSelect: true, select2: {value: relationBranchList.getEditedBranch().relationship.relationshiptype, placeholder: 'Type', dataKey: 'RELATIONSHIP_TYPES.E32'}"></input>
                                                            <div class="btn-group" style="margin-left: 5px;">
                                                                <button type="button" class="add-button btn btn-primary" style="height: 32px;" data-bind="click: addClick">{% trans "Add" %}</button>
                                                                <button type="button" class="btn btn-primary dropdown-toggle" style="height: 32px;" data-toggle="dropdown">
                                                                    <i class="fa fa-chevron-down"></i>
                                                                    <span class="sr-only">{% trans "Toggle Dropdown" %}</span>                            
                                                                </button>
                                                                <ul class="dropdown-menu" role="menu">
                                                                    <li><a href="#" name="discard-edit-link" data-bind="click: discardClick">{% trans "Discard edits" %}</a></li>
                                                                </ul>
                                                            </div>
                                                            <!-- Classification and dates -->
                                                            <div class="row" style="margin-top: 10px;margin-bottom: 10px;padding-right: 162px;">
                                                                <div style="">
                                                                    <div id="from-date-section" class="col-xs-12 col-sm-6">
                                                                        <div class="input-group datetimepicker" style ="width:100%;" >
                                                                            <input type="text" id="date" style="height: 32px;" placeholder="{% trans 'from (yyyy-mm-dd)' %}" class="form-control datepicker" data-date-format="YYYY-MM-DD" data-bind="{value: relationBranchList.getEditedBranch().relationship.datestarted, datePicker: true} ">
                                                                            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                                                        </div>
                                                                        <div class="hidden-sm hidden-md hidden-lg" style="margin-bottom: 5px;">
                                                                        </div>
                                                                    </div>
                                                                    <div id="to-date-section" class="col-xs-12 col-sm-6">
                                                                        <div class="input-group datetimepicker" style ="width:100%;" >
                                                                            <input type="text" id="date" style="height: 32px;" placeholder="{% trans 'to (yyyy-mm-dd)' %}" class="form-control datepicker" data-date-format="YYYY-MM-DD" data-bind="{value: relationBranchList.getEditedBranch().relationship.dateended, datePicker: true} ">
                                                                            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- Simple HTML Editor -->
                                                            <div class="arches-html-editor margin-top-5" style="width: 80%;">
                                                                <div class="summernote" data-bind="summernote: {value: relationBranchList.getEditedBranch().relationship.notes, options:{}}"></div>
                                                            </div>
                                                        </div>
                                                    </form>
                                                    <!-- Form for screens > xs -->
                                                </div>
                                            </div>
                                        </dd>
                                        <div class="alert alert-danger branch-invalid-alert" role="alert" style="display:none;">{% trans "All values must be populated." %}</div>
                                        <hr class="margin-10 margin-top-20">
                                    </div>
                                </div>
                            </div>
                            <div class="margin-bottom-30"></div>
                            <div id="paginator" data-bind="html: paginator"></div>
                        </div> 
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock form_content %}